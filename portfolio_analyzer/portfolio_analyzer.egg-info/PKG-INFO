Metadata-Version: 2.4
Name: portfolio-analyzer
Version: 1.3.4
Summary: A comprehensive Python tool for analyzing stock portfolio performance with precise cash flow tracking and S&P 500 benchmarking.
Author-email: Zhuo Robert Li <zhuo.robert.li@example.com>
License: ISC
Project-URL: Homepage, https://github.com/zhuoli/stock
Project-URL: Documentation, https://github.com/zhuoli/stock/blob/main/portfolio_analyzer/README.md
Project-URL: Repository, https://github.com/zhuoli/stock.git
Project-URL: Issues, https://github.com/zhuoli/stock/issues
Keywords: portfolio-analysis,stock-portfolio,investing,xirr,cagr,s&p-500,benchmarking,financial-analysis
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Financial and Insurance Industry
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: ISC License (ISCL)
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Topic :: Office/Business :: Financial :: Investment
Classifier: Topic :: Scientific/Engineering :: Information Analysis
Requires-Python: >=3.8
Description-Content-Type: text/markdown
Requires-Dist: yfinance>=0.2.0
Requires-Dist: pandas>=1.3.0
Requires-Dist: numpy>=1.20.0
Requires-Dist: scipy>=1.7.0
Requires-Dist: matplotlib>=3.3.0
Requires-Dist: seaborn>=0.11.0
Requires-Dist: plotly>=5.0.0
Requires-Dist: reportlab>=3.6.0
Provides-Extra: dev
Requires-Dist: pytest>=7.0.0; extra == "dev"
Requires-Dist: pytest-cov>=4.0.0; extra == "dev"
Requires-Dist: build>=0.10.0; extra == "dev"
Requires-Dist: twine>=4.0.0; extra == "dev"

# Portfolio Analyzer

A comprehensive Python tool for analyzing stock portfolio performance with precise cash flow tracking and S&P 500 benchmarking.

## Why This Tool

**Better than fixed-period snapshots:**
Standard apps show returns for fixed periods (1, 3, 5, 10 years) by comparing two snapshots. This misses important context:
- If you invested $5K one year ago and $20K three months ago, the "1 year return" ignores that most of your money hasn't been invested for 1 year
- XIRR accounts for this - your actual time-weighted return is much more accurate than simple snapshots

**Know if active stock picking is worth it:**
This tool compares your portfolio to S&P 500 to help answer: "Should I just buy an index fund instead?"
- If consistently underperforming S&P 500, a low-cost index fund might be a better strategy
- Helps separate skill from luck - are you outperforming the market, or just lucky?
- You decide what to do with this information - the tool removes the guesswork

**Multi-period analysis at any time interval:**
Unlike apps locked to 1/3/5/10 year periods, analyze any date range you want
- "What was my return from March 2023 to now?"
- "How did I perform in the bull market of 2024?" 
- Compare any periods without artificial constraints

**Real cash flow accounting:**
- **When** you invested your money
- **How much** you invested at each time  
- **Real returns** accounting for your actual investment patterns

This tool uses **XIRR (Internal Rate of Return)** to calculate your true performance accounting for investment timing and amounts. Combined with **real S&P 500 market data**, you get exact comparisons to help guide your investment decisions.

## Features

- **Cash Flow Tracking**: Complete investment timeline tracking with XIRR calculations
  - Accounts for when and how much you invested
  - Accurately reflects your true returns vs random snapshots
  - Weighted CAGR reflects your actual capital deployment
  
- **CAGR & XIRR Analysis**: 
  - Compound Annual Growth Rate for simple long-term performance
  - Extended Internal Rate of Return for time-weighted accuracy
  - Works correctly with irregular investment patterns

- **S&P 500 Benchmarking**: 
  - Real market data from yfinance (never estimates or approximations)
  - Precise outperformance calculation vs actual market performance
  - Trade-level and portfolio-level benchmark comparison
  
- **Detailed Performance Metrics**:
  - Symbol-level aggregation showing performance per stock
  - Weighted metrics accounting for investment size and duration
  - Gain/loss breakdown and win/loss rates
  - Comprehensive trade-level analysis

- **Multiple Report Formats**:
  - Text reports with detailed analysis
  - PDF reports with professional visualizations and charts
  - Interactive HTML dashboards with Plotly charts and dark mode support
  
- **Transparent & Auditable**: 
  - 149 tests (91% coverage) validate every calculation
  - Open source - inspect exactly how calculations work
  - No black boxes or mysterious algorithms
  
- **Production Ready**: v1.3.4 with comprehensive test coverage and validation

## Installation

```bash
# Required dependencies
pip install yfinance pandas numpy scipy

# Optional (for visualizations)
pip install matplotlib seaborn plotly reportlab
```

## Quick Start

### Try the Example

The `examples/` directory contains a sample portfolio with pre-generated outputs:

- **Input**: `examples/example_trades.csv` (12-stock portfolio)
- **Outputs**: 
  - `examples/example_report.txt` (Text report with detailed analysis)
  - `examples/example_report.pdf` (PDF with charts and visualizations)
  - **[`examples/example_report.html`](https://rawcdn.githack.com/zhybear/finance_tools/main/portfolio_analyzer/examples/example_report.html)** (Interactive HTML dashboard - click to preview)

Generate these yourself:
```bash
python -m portfolio_analyzer.cli --csv examples/example_trades.csv --output examples/example_report.txt --pdf examples/example_report.pdf --html examples/example_report.html
```

### Command Line

```bash
# Analyze trades from CSV
python -m portfolio_analyzer.cli --csv trades.csv

# Generate text report
python -m portfolio_analyzer.cli --csv trades.csv --output report.txt

# Generate PDF with charts
python -m portfolio_analyzer.cli --csv trades.csv --pdf report.pdf

# Generate interactive HTML dashboard
python -m portfolio_analyzer.cli --csv trades.csv --html report.html

# All formats at once
python -m portfolio_analyzer.cli --csv trades.csv --output report.txt --pdf report.pdf --html report.html
```

### Python API

```python
from portfolio_analyzer import PortfolioAnalyzer, load_trades_from_csv

# Load trades
trades = load_trades_from_csv("trades.csv")

# Create analyzer
analyzer = PortfolioAnalyzer(trades)

# Generate reports
analyzer.print_report()
analyzer.generate_pdf_report("report.pdf")
analyzer.generate_html_report("dashboard.html")

# Access analysis data
analysis = analyzer.analyze_portfolio()
print(f"Portfolio CAGR: {analysis['portfolio_cagr']:.2f}%")
print(f"Portfolio XIRR: {analysis['portfolio_xirr']:.2f}%")
```

## CSV Format

```csv
symbol,shares,purchase_date,price
SBUX,100,2015-04-15,48.14
MSFT,75,2016-08-22,57.67
NVDA,50,2018-06-10,6.56
```

Prices shown are historical close values (adjusted for splits/dividends) for the trading dates listed.

## Testing

```bash
# Run all tests (124 total)
python -m unittest discover -s tests -p "test_*.py" -v

# Run specific test module
python -m unittest tests.test_analyzer -v
python -m unittest tests.test_reports -v
python -m unittest tests.test_loaders -v

# Quick run (quiet mode)
python -m unittest discover -s tests -p "test_*.py" -q
```

**Test Coverage**: 91% (149 tests across Phases 1-3: 66 new edge case, production hardening, and analytics validation tests)

## Architecture

- **analyzer.py**: Core portfolio analysis engine
- **metrics.py**: CAGR and XIRR calculations
- **reports.py**: Text, PDF, and HTML report generation
- **loaders.py**: CSV file loading and validation
- **utils.py**: Helper functions and utilities
- **cli.py**: Command-line interface

## Version

Current version: **1.3.4** (Production Ready)

See RELEASE_NOTES.md for detailed changelog.
